puts File.read("input").split("\n\n").map{_1.split("\n")}.each_with_index.map{|v,i| i == 0 ? v.map{_1.chars.each_slice(4).to_a.map(&:join).map(&:strip)}.transpose.map{_1.map{|e| e[1]}.reverse}.map{_1.select{|e| !e.nil?}} : v.map{_1.scan(/\d+/).map(&:to_i)}}.tap{|v| v[1].each{|i| v[0][i[2]-1].push(*v[0][i[1]-1].pop(i[0]))}}[0].map(&:last).join
